<html>
    <canvas id="myCanvas" width="800" height="600" style="border:1px solid #000000;">
    </canvas>
    <script>
      var laser1 = {x:800, y:300, r:300, angle:Math.PI };
      var laser2 = {x:400, y:0, r:300, angle:0 };
      var laser3 = {x:0, y:300, r:300, angle:0 };
      var laser4 = {x:400, y:600, r:300, angle:0 };
      var lasers = [laser1];//, laser2, laser3, laser4];
      var keys = {}; 
      var gamma = .1;
      var maxvel = 5;
      var alpha = 1;
      var circle = {pos:[400, 300], vel:[0,0], r:10};
      var beta = 5;
      var angleStep = .01;
      function render(circle, lasers) {
        var c = document.getElementById("myCanvas");
        var ctx = c.getContext("2d");
        ctx.clearRect(0, 0, c.width, c.height);
        drawCircle(circle);
        drawLasers(lasers);
      }
      function drawCircle(circle) {

        var c = document.getElementById("myCanvas");
        var ctx = c.getContext("2d");
        ctx.beginPath();
        ctx.arc(circle.pos[0], circle.pos[1], circle.r, 0, 2 * Math.PI);
        ctx.stroke();
      }
      function moveCircle(circle) {
         circle.pos[0] = circle.vel[0] * alpha + circle.pos[0];
         circle.pos[1] = circle.vel[1] * alpha + circle.pos[1];
         if(circle.pos[0] > 800 - circle.r) {
          circle.pos[0] = 800 - circle.r;
          circle.vel[0] = circle.vel[0] * (-1);
         }
         if(circle.pos[0] < 0 + circle.r) {
          circle.pos[0] = 0 + circle.r;
          circle.vel[0] = circle.vel[0] * (-1);
         }
         if(circle.pos[1] > 600 - circle.r) {
          circle.pos[1]  = 600 - circle.r;
          circle.vel[1] = circle.vel[1] * (-1);
         }
         if(circle.pos[1] < 0 + circle.r) {
          circle.pos[1] = 0 + circle.r;
          circle.vel[1] = circle.vel[1] * (-1);
         }
         circle.vel[0] = circle.vel[0] - gamma * circle.vel[0];
         circle.vel[1] = circle.vel[1] - gamma * circle.vel[1];
      }
      function keyDown(e) {
       keys[e.key] = 1;
      }
      function keyUp(e) {
       keys[e.key] = 0;
      }
      function changeVelocity(circle) {
        if(keys['d'] === 1){
          circle.vel[0] = circle.vel[0] + beta;
        } 
        if(keys['a'] === 1){
          circle.vel[0] = circle.vel[0] - beta;
        } 
        if(keys['s'] === 1){
          circle.vel[1] = circle.vel[1] + beta;
        } 
        if(keys['w'] === 1){
          circle.vel[1] = circle.vel[1] - beta;
        }
        var totalvel = Math.sqrt(circle.vel[0] * circle.vel[0] + circle.vel[1] * circle.vel[1]);
        if(totalvel > maxvel) {
          circle.vel[0] = circle.vel[0] * maxvel / totalvel;
          circle.vel[1] = circle.vel[1] * maxvel / totalvel;
        }
      } 
      // for next time ask brady about function arguements 
      function drawLasers(lasers) {
        for (i = 0; i < lasers.length; i++) {
          var laser = lasers[i];
          var c = document.getElementById("myCanvas");
          var ctx = c.getContext("2d");
          ctx.beginPath();
          ctx.moveTo(laser.x, laser.y);
          var lineX = laser.x + laser.r * Math.cos(laser.angle);
          var lineY = laser.y + laser.r * Math.sin(laser.angle);
          ctx.lineTo(lineX, lineY);
          ctx.stroke();
        }
      }
      function checkCollisions(circle, lasers) {
        var c = document.getElementById("myCanvas");
        for (i = 0; i < lasers.length; i++) {
          var laser = lasers[i];
          
          var laserX = laser.x + laser.r * Math.cos(laser.angle);
          var laserY = laser.y + laser.r * Math.sin(laser.angle);
          if (laserX < 0 || laserX > c.width || laserY < 0 || laserY > c.height ) {
            continue;
          }

          var circleX = circle.pos[0] - laser.x;
          var circleY = circle.pos[1] - laser.y;
          var lineX = laser.r * Math.cos(laser.angle);
          var lineY = laser.r * Math.sin(laser.angle);
          var c = Math.sqrt(lineX * lineX + lineY * lineY);
          var difC = circleX * lineX / c + circleY * lineY / c;
          var difX = circleX - difC * lineX / c;
          var difY = circleY - difC * lineY / c; 
          var dist = Math.sqrt(difX * difX + difY * difY);
          if (dist < circle.r) {
            var circleDist = Math.sqrt((circle.pos[0] - laser.x)**2 + (circle.pos[1] - laser.y)**2);
            if (circleDist < laser.r + circle.r) {
              return true;
            }
          } 
        } 
        return false;
      }
      function reset(circle) {
        circle.pos = [400, 300];
        circle.vel = [0, 0];
      }
      window.addEventListener("keyup", keyUp);
      window.addEventListener("keydown", keyDown);
      function moveLasers(lasers) {
        for (i = 0; i < lasers.length; i++) {
          lasers[i].angle = lasers[i].angle + angleStep; 
        }
      }
      
      function step() {
        var collide = checkCollisions(circle, lasers);
        if (collide) {
          reset(circle);
          console.log("collide");
        }

        changeVelocity(circle);
        moveLasers(lasers);
        moveCircle(circle);
        render(circle, lasers);
      }

    setInterval(step, 20);
    </script>

</html>